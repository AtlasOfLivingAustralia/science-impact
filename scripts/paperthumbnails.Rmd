---
title: "paperthumbnails"
author: "Olivia"
date: "2023-03-28"
output: html_document
editor_options: 
  chunk_output_type: console
---
#load packages
```{r}
library(ggplot2)
library(ggtext)
library(extrafont)
library(tidyverse)
library(here)
library(scales)
#remotes::install_github("AndreaCirilloAC/paletter")
library(paletter)
```

note that for `geom_textbox` in `ggtext` to change fonts, fonts need to be locally installed on your system as well as in R. `showtext` function `font_add_google` won't allow geom_textbox to retrieve fonts as they are not saved in the right space. Download them onto your font system and then use the code below to import and load, as well as browse available fonts. I've used the Poppins font: (https://fonts.google.com/specimen/Poppins)

#prepare fonts

```{r}
#import and then load all fonts in your computer to r
extrafont::font_import()
loadfonts()
```

```{r}
#view all fonts available
as_tibble(fonts())
```


#colour palette generation

##ALA colour hex codes

using colours from images within the official ALA colour palette (below)

```{r, EVAL = false}
# ALA colours 
primary colours:
"#E06E53", "#B8573E", "#667073"

extended colours:
"#FFC557", "#B7CD96", "#6BDAD5"

secondary colours:
"#EEECEA", "#9E9E9F", "#222322","#003A70", "#A191B2", "#691C32"

```


##extract image colours


```{r, EVAL = false}
#generate palette from selected image
image_pal <- create_palette(
  image_path = "/Users/tor057/Desktop/flower.jpeg",
  type_of_variable = "categorical", 
  number_of_colors = 5)
image_pal
```


```{r}
# Sample list of hex codes (ALA colours)
hex_list1 <- c("#E06E53", "#B8573E", "#667073", "#FFC557", "#B7CD96", "#6BDAD5", "#EEECEA", "#9E9E9F", "#222322","#003A70", "#A191B2", "#691C32")

# List of hex codes to match against - what we extracted from our image
hex_list2 <- image_pal

# Function to get the closest match from hex_list2 for a given hex code
get_closest_match <- function(hex_code) {
  # Convert hex code to RGB
  rgb_code <- col2rgb(hex_code)
  # Calculate distance between each color in the two lists
  distances <- apply(col2rgb(hex_list2), 2, function(x) sum((x - rgb_code)^2))
  # Return the hex code with the closest match
  hex_list2[which.min(distances)]}

# Get the closest match for each hex code in hex_list1
closest_matches <- sapply(hex_list1, get_closest_match)

# Remove duplicates and NA values and keep only the first three elements
closest_matches <- head(unique(na.omit(closest_matches)), 3)

# Print the matching hex codes
print(closest_matches)

# Visualise the matching hex codes
show_col(closest_matches)
```


## *** thumbnail generation

In this area I need to auto generate the correct colours to insert inter their respective positions - for the textbox, the backing colour (plot and panel) and also the small rectangle accent in the right hand corner 

```{r}
lab_long <- "**An image has generate a palette for a thumbnail here!**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 19,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "*****",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "*****",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "*****", color = NA),
       plot.background = element_rect(fill = "*****"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```




## other thumbnail examples: 

1. peanuts

```{r}
lab_long <- "**Peanut cropping under a changing climate**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 19,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "#FFC557",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "#9E9E9F",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "#B7CD96", color = NA),
       plot.background = element_rect(fill = "#B7CD96"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```

```{r}
ggsave(file = "peanuts.png")
```


2. termites 
```{r}
lab_long <- "**Termites: climate change winners?**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 19,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "#B8573E",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "#E06E53",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "#FFC557", color = NA),
       plot.background = element_rect(fill = "#FFC557"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```

```{r}
ggsave(file = "termites.png")
```


3.  jacaranda trees

```{r}
lab_long <- "**When do Jacaranda trees bloom?**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 19,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "#B7CD96",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "#6BDAD5",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "#A191B2", color = NA),
       plot.background = element_rect(fill = "#A191B2"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```

```{r}
ggsave(file = "jacarandas.png")
```


4. mosquito

```{r}
lab_long <- "**Mapping transmission risk: Japanese Encephalitis Virus (JEV)**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 15,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "#EEECEA",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "#9E9E9F",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "#222322", color = NA),
       plot.background = element_rect(fill = "#222322"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```

```{r}
ggsave(file = "JEV.png")
```


```{r}
lab_long <- "**Divided by road: koala habitat & genetic breakdown**"

p <- ggplot() + 
  geom_textbox(aes(x = 0.45,
                   y = 0.55, 
                   label = lab_long),
               size = 15,
               width = unit(27, "lines"),
               stat = "unique", 
               family = "Poppins",
               colour = "#6BDAD5",
               fill = NA, 
               box.colour = NA) +
  geom_rect(aes(xmin = 0.5, xmax = 1, ymin = 0.1, ymax = 0.13),
           fill = "#B7CD96",
           color = "NA") +
  scale_y_continuous(limits = c(0,1)) +
  scale_x_continuous(limits = c(0, 1)) +
theme(panel.border = element_blank(),
       panel.background = element_rect(fill = "#667073", color = NA),
       plot.background = element_rect(fill = "#667073"), #remove white space from x/y region
       panel.grid = element_blank(), #remove labels, ticks etc. 
       axis.text = element_blank(),
       axis.ticks = element_blank(),
       axis.title = element_blank(),
       plot.margin = margin(0, 0, 0, 0, "cm")) #remove white space from right and top borders 
p
```

```{r}
ggsave(file = "koala.png")
```



